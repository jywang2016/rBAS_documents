<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>第 9 章 Matlab用户 | rBAS使用文档</title>
  <meta name="description" content="rBAS中文使用说明文档V0.2">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="第 9 章 Matlab用户 | rBAS使用文档 />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="rBAS中文使用说明文档V0.2" />
  <meta name="github-repo" content="jywang2016/rBAS" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 9 章 Matlab用户 | rBAS使用文档 />
  
  <meta name="twitter:description" content="rBAS中文使用说明文档V0.2" />
  

<meta name="author" content="王江宇">


<meta name="date" content="2018-12-19">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="python.html">
<link rel="next" href="paper.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">rBAS中文文档</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-1"><i class="fa fa-check"></i>手册内容概述</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-2"><i class="fa fa-check"></i>夹带私货</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-3"><i class="fa fa-check"></i>致谢</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> R以及rBAS安装</a><ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html#Rinstall"><i class="fa fa-check"></i><b>1.1</b> R安装</a></li>
<li class="chapter" data-level="1.2" data-path="install.html"><a href="install.html#Rstudioinstall"><i class="fa fa-check"></i><b>1.2</b> Rstudio安装</a></li>
<li class="chapter" data-level="1.3" data-path="install.html"><a href="install.html#rBASinstall"><i class="fa fa-check"></i><b>1.3</b> rBAS安装</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithm.html"><a href="algorithm.html"><i class="fa fa-check"></i><b>2</b> 算法原理</a><ul>
<li class="chapter" data-level="2.1" data-path="algorithm.html"><a href="algorithm.html#bas"><i class="fa fa-check"></i><b>2.1</b> BAS</a><ul>
<li class="chapter" data-level="2.1.1" data-path="algorithm.html"><a href="algorithm.html#BASflow"><i class="fa fa-check"></i><b>2.1.1</b> 算法流程</a></li>
<li class="chapter" data-level="2.1.2" data-path="algorithm.html"><a href="algorithm.html#BASimprove"><i class="fa fa-check"></i><b>2.1.2</b> 不足与改进</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="algorithm.html"><a href="algorithm.html#bsas"><i class="fa fa-check"></i><b>2.2</b> BSAS</a><ul>
<li class="chapter" data-level="2.2.1" data-path="algorithm.html"><a href="algorithm.html#BSASflow"><i class="fa fa-check"></i><b>2.2.1</b> 与BAS不同之处</a></li>
<li class="chapter" data-level="2.2.2" data-path="algorithm.html"><a href="algorithm.html#BSASimprove"><i class="fa fa-check"></i><b>2.2.2</b> 不足与改进</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithm.html"><a href="algorithm.html#bas-wpt"><i class="fa fa-check"></i><b>2.3</b> BAS-WPT</a><ul>
<li class="chapter" data-level="2.3.1" data-path="algorithm.html"><a href="algorithm.html#BASWPTflow"><i class="fa fa-check"></i><b>2.3.1</b> 与BAS不同之处</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithm.html"><a href="algorithm.html#constrform"><i class="fa fa-check"></i><b>2.3.2</b> 约束问题抽象形式</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithm.html"><a href="algorithm.html#BSASimprove2"><i class="fa fa-check"></i><b>2.3.3</b> 不足与改进</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithm.html"><a href="algorithm.html#BAS2"><i class="fa fa-check"></i><b>2.4</b> BAS with momentum(second-order BAS)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="algorithm.html"><a href="algorithm.html#section-6"><i class="fa fa-check"></i><b>2.4.1</b> 算法原理</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithm.html"><a href="algorithm.html#section-7"><i class="fa fa-check"></i><b>2.4.2</b> 不足与改进</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html"><i class="fa fa-check"></i><b>3</b> 混合算法</a><ul>
<li class="chapter" data-level="3.1" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#bso"><i class="fa fa-check"></i><b>3.1</b> BSO</a><ul>
<li class="chapter" data-level="3.1.1" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#section-8"><i class="fa fa-check"></i><b>3.1.1</b> 粒子群算法流程</a></li>
<li class="chapter" data-level="3.1.2" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#bas-1"><i class="fa fa-check"></i><b>3.1.2</b> 与BAS的结合</a></li>
<li class="chapter" data-level="3.1.3" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#section-9"><i class="fa fa-check"></i><b>3.1.3</b> 总结</a></li>
<li class="chapter" data-level="3.1.4" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#BSOparms"><i class="fa fa-check"></i><b>3.1.4</b> 算法调用说明</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#bBASa"><i class="fa fa-check"></i><b>3.2</b> bBAS</a><ul>
<li class="chapter" data-level="3.2.1" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#section-10"><i class="fa fa-check"></i><b>3.2.1</b> 算法流程</a></li>
<li class="chapter" data-level="3.2.2" data-path="mixedalgorithm.html"><a href="mixedalgorithm.html#section-11"><i class="fa fa-check"></i><b>3.2.2</b> 总结</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rBAS.html"><a href="rBAS.html"><i class="fa fa-check"></i><b>4</b> 函数使用</a><ul>
<li class="chapter" data-level="4.1" data-path="rBAS.html"><a href="rBAS.html#basoptim"><i class="fa fa-check"></i><b>4.1</b> BASoptim/BASoptim2</a><ul>
<li class="chapter" data-level="4.1.1" data-path="rBAS.html"><a href="rBAS.html#BASparms"><i class="fa fa-check"></i><b>4.1.1</b> BASoptim参数说明</a></li>
<li class="chapter" data-level="4.1.2" data-path="rBAS.html"><a href="rBAS.html#BAS2parms"><i class="fa fa-check"></i><b>4.1.2</b> BAS2optim参数说明</a></li>
<li class="chapter" data-level="4.1.3" data-path="rBAS.html"><a href="rBAS.html#BASexamples"><i class="fa fa-check"></i><b>4.1.3</b> BASoptim简单案例</a></li>
<li class="chapter" data-level="4.1.4" data-path="rBAS.html"><a href="rBAS.html#BAS2examples"><i class="fa fa-check"></i><b>4.1.4</b> BASoptim2简单案例</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="rBAS.html"><a href="rBAS.html#bsasoptim"><i class="fa fa-check"></i><b>4.2</b> BSASoptim</a><ul>
<li class="chapter" data-level="4.2.1" data-path="rBAS.html"><a href="rBAS.html#BSASparms"><i class="fa fa-check"></i><b>4.2.1</b> BSASoptim参数说明</a></li>
<li class="chapter" data-level="4.2.2" data-path="rBAS.html"><a href="rBAS.html#BSAStrick"><i class="fa fa-check"></i><b>4.2.2</b> BSASoptim取值摸索</a></li>
<li class="chapter" data-level="4.2.3" data-path="rBAS.html"><a href="rBAS.html#BSASexample"><i class="fa fa-check"></i><b>4.2.3</b> BSASoptim案例</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="rBAS.html"><a href="rBAS.html#bsaswpt"><i class="fa fa-check"></i><b>4.3</b> BSAS-WPT</a><ul>
<li class="chapter" data-level="4.3.1" data-path="rBAS.html"><a href="rBAS.html#bsaswptparms"><i class="fa fa-check"></i><b>4.3.1</b> BSAS-WPT 参数说明</a></li>
<li class="chapter" data-level="4.3.2" data-path="rBAS.html"><a href="rBAS.html#bsaswptexample"><i class="fa fa-check"></i><b>4.3.2</b> BSAS-WPT 案例</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="rBAS.html"><a href="rBAS.html#bsooptim"><i class="fa fa-check"></i><b>4.4</b> BSOoptim</a><ul>
<li class="chapter" data-level="4.4.1" data-path="rBAS.html"><a href="rBAS.html#BSOfuncparms"><i class="fa fa-check"></i><b>4.4.1</b> BSO参数说明</a></li>
<li class="chapter" data-level="4.4.2" data-path="rBAS.html"><a href="rBAS.html#bsoexample"><i class="fa fa-check"></i><b>4.4.2</b> BSO案例</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="rBAS.html"><a href="rBAS.html#bBASr"><i class="fa fa-check"></i><b>4.5</b> bBAS</a><ul>
<li class="chapter" data-level="4.5.1" data-path="rBAS.html"><a href="rBAS.html#bBASfuncparms"><i class="fa fa-check"></i><b>4.5.1</b> bBAS参数说明</a></li>
<li class="chapter" data-level="4.5.2" data-path="rBAS.html"><a href="rBAS.html#bBASexamples"><i class="fa fa-check"></i><b>4.5.2</b> bBAS案例</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="interface.html"><a href="interface.html"><i class="fa fa-check"></i><b>5</b> 用户界面</a><ul>
<li class="chapter" data-level="5.1" data-path="interface.html"><a href="interface.html#section-12"><i class="fa fa-check"></i><b>5.1</b> 调用语句</a></li>
<li class="chapter" data-level="5.2" data-path="interface.html"><a href="interface.html#section-13"><i class="fa fa-check"></i><b>5.2</b> 使用案例</a><ul>
<li class="chapter" data-level="5.2.1" data-path="interface.html"><a href="interface.html#michalewicz-function-2"><i class="fa fa-check"></i><b>5.2.1</b> Michalewicz function</a></li>
<li class="chapter" data-level="5.2.2" data-path="interface.html"><a href="interface.html#pressure-vessel-function-1"><i class="fa fa-check"></i><b>5.2.2</b> Pressure Vessel function</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="interface.html"><a href="interface.html#authors"><i class="fa fa-check"></i><b>5.3</b> Authors界面</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>6</b> BAS案例一:多杆机构优化问题</a><ul>
<li class="chapter" data-level="6.1" data-path="examples.html"><a href="examples.html#section-14"><i class="fa fa-check"></i><b>6.1</b> 背景</a><ul>
<li class="chapter" data-level="6.1.1" data-path="examples.html"><a href="examples.html#bars4"><i class="fa fa-check"></i><b>6.1.1</b> 四连杆机构(Four-bar linkage mechanism)</a></li>
<li class="chapter" data-level="6.1.2" data-path="examples.html"><a href="examples.html#bars6"><i class="fa fa-check"></i><b>6.1.2</b> 六连杆机构(Stephenson III Six-bar linkage mechanism)</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="examples.html"><a href="examples.html#section-15"><i class="fa fa-check"></i><b>6.2</b> 优化问题</a><ul>
<li class="chapter" data-level="6.2.1" data-path="examples.html"><a href="examples.html#bars4optim"><i class="fa fa-check"></i><b>6.2.1</b> 四连杆机构</a></li>
<li class="chapter" data-level="6.2.2" data-path="examples.html"><a href="examples.html#bars6optim"><i class="fa fa-check"></i><b>6.2.2</b> 六连杆机构</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="examples.html"><a href="examples.html#section-16"><i class="fa fa-check"></i><b>6.3</b> 优化理论</a></li>
<li class="chapter" data-level="6.4" data-path="examples.html"><a href="examples.html#section-17"><i class="fa fa-check"></i><b>6.4</b> 优化结果</a><ul>
<li class="chapter" data-level="6.4.1" data-path="examples.html"><a href="examples.html#case1-path-generation-without-prescribed-timing"><i class="fa fa-check"></i><b>6.4.1</b> Case1 无规定时间内轨迹生成(Path generation without prescribed timing)</a></li>
<li class="chapter" data-level="6.4.2" data-path="examples.html"><a href="examples.html#case2-with-prescribed-timing"><i class="fa fa-check"></i><b>6.4.2</b> Case2 有规定时间的轨迹生成(with prescribed timing)</a></li>
<li class="chapter" data-level="6.4.3" data-path="examples.html"><a href="examples.html#case3-path-generation-with-prescribed-timing"><i class="fa fa-check"></i><b>6.4.3</b> Case3 规定时间内路径生成（Path generation with prescribed timing）</a></li>
<li class="chapter" data-level="6.4.4" data-path="examples.html"><a href="examples.html#case4-"><i class="fa fa-check"></i><b>6.4.4</b> Case4 规定时间路径生成问题</a></li>
<li class="chapter" data-level="6.4.5" data-path="examples.html"><a href="examples.html#case5-"><i class="fa fa-check"></i><b>6.4.5</b> Case5 规定时间内路径生成问题</a></li>
<li class="chapter" data-level="6.4.6" data-path="examples.html"><a href="examples.html#case6-"><i class="fa fa-check"></i><b>6.4.6</b> Case6 六杆机构路径生成</a></li>
<li class="chapter" data-level="6.4.7" data-path="examples.html"><a href="examples.html#case7-"><i class="fa fa-check"></i><b>6.4.7</b> Case7 无规定时间的路径生成</a></li>
<li class="chapter" data-level="6.4.8" data-path="examples.html"><a href="examples.html#case8-"><i class="fa fa-check"></i><b>6.4.8</b> Case8 无规定时间的路径生成</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="examples2.html"><a href="examples2.html"><i class="fa fa-check"></i><b>7</b> BAS案例二:龙门起重机运动控制</a><ul>
<li class="chapter" data-level="7.1" data-path="examples2.html"><a href="examples2.html#section-18"><i class="fa fa-check"></i><b>7.1</b> 问题背景</a></li>
<li class="chapter" data-level="7.2" data-path="examples2.html"><a href="examples2.html#section-19"><i class="fa fa-check"></i><b>7.2</b> 优化问题抽象</a></li>
<li class="chapter" data-level="7.3" data-path="examples2.html"><a href="examples2.html#section-20"><i class="fa fa-check"></i><b>7.3</b> 优化理论</a></li>
<li class="chapter" data-level="7.4" data-path="examples2.html"><a href="examples2.html#section-21"><i class="fa fa-check"></i><b>7.4</b> 优化结果</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="python.html"><a href="python.html"><i class="fa fa-check"></i><b>8</b> Python接口</a><ul>
<li class="chapter" data-level="8.1" data-path="python.html"><a href="python.html#section-22"><i class="fa fa-check"></i><b>8.1</b> 安装方式</a></li>
<li class="chapter" data-level="8.2" data-path="python.html"><a href="python.html#section-23"><i class="fa fa-check"></i><b>8.2</b> 使用</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="matlabr.html"><a href="matlabr.html"><i class="fa fa-check"></i><b>9</b> Matlab用户</a><ul>
<li class="chapter" data-level="9.1" data-path="matlabr.html"><a href="matlabr.html#r.matlab"><i class="fa fa-check"></i><b>9.1</b> 使用R.matlab包</a></li>
<li class="chapter" data-level="9.2" data-path="matlabr.html"><a href="matlabr.html#cc"><i class="fa fa-check"></i><b>9.2</b> 中转站：C/C++</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="paper.html"><a href="paper.html"><i class="fa fa-check"></i><b>10</b> 已发表工作</a><ul>
<li class="chapter" data-level="10.1" data-path="paper.html"><a href="paper.html#section-24"><i class="fa fa-check"></i><b>10.1</b> 工具箱/软件</a></li>
<li class="chapter" data-level="10.2" data-path="paper.html"><a href="paper.html#section-25"><i class="fa fa-check"></i><b>10.2</b> 论文</a></li>
<li class="chapter" data-level="10.3" data-path="paper.html"><a href="paper.html#section-26"><i class="fa fa-check"></i><b>10.3</b> 专利</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="updates.html"><a href="updates.html"><i class="fa fa-check"></i><b>11</b> 更新及维护计划</a><ul>
<li class="chapter" data-level="11.1" data-path="updates.html"><a href="updates.html#section-27"><i class="fa fa-check"></i><b>11.1</b> 待加入的功能</a></li>
<li class="chapter" data-level="11.2" data-path="updates.html"><a href="updates.html#section-28"><i class="fa fa-check"></i><b>11.2</b> 联系方式</a></li>
</ul></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="" data-path="section-29.html"><a href="section-29.html"><i class="fa fa-check"></i>结语</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书基于 bookdown 编写</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">rBAS使用文档</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="matlabr" class="section level1">
<h1><span class="header-section-number">第 9 章</span> Matlab用户</h1>
<p>之前一直有同学在群里面反映，有没有matlab用户可以使用rBAS的方法。尽管我曾经也是matlab的忠实用户，但现在能力退化严重，实在是写不动代码。加之，我认为学习R的成本很低，而且更加便捷。因此，也就熄了再去做一个matlab toolbox的心思。</p>
<p>不过，我还是决定尝试下是否存在两者的接口，可以完成参数的传递，让使用matlab的同学也可以使用rBAS。于是有了下面几点思路。</p>
<ul>
<li>使用matlab，通过R(D)COM服务器来与R通讯，其配置对于R用户而言尚且显得麻烦，何况matlab用户。不过在看mathwork的网站时，倒是得知他们把R interface作为了未来的开发计划之一。所以，日后可以采用在matlab中调用R的形式。目前尚无此功能。</li>
<li>使用R中的R.matlab包，来与matlab通讯。这个办法咋一看很简单，尝试也成功了。最大的问题是<strong>慢</strong>，其次看源码应该是要配置<strong>Java</strong>(我电脑上原本有，执行无碍，但没有删除Java后尝试)。这种慢，可以称为很慢，后面我们能见识到。</li>
<li>使用<strong>第三方语言</strong>，如C/C++。别害怕，因为matlab提供了很强大的工具，即<code>Matlab Coder</code>来把你的matlab代码转为C或者C++。</li>
</ul>
<p>下面我们讲第二点和第三点是如何操作的。</p>
<div id="r.matlab" class="section level2">
<h2><span class="header-section-number">9.1</span> 使用R.matlab包</h2>
<p>这一节更类似于娱乐和探索。因为该方法用于优化求解的速度，真的让人难以接受（也有可能是我没有找对方法）。如果无意于此，可以跳过。</p>
<p>首先，可以按照下面的代码从CRAN安装该包。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&#39;R.matlab&#39;</span>)</code></pre>
<p>当然，也可以利用<code>devtools</code>从github上按照该包。</p>
<pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&#39;HenrikBengtsson/R.matlab&#39;</span>)</code></pre>
<p>接下来，按照<a href="https://cran.r-project.org/web/packages/R.matlab/R.matlab.pdf">包的文档</a>进行操作。</p>
<p>首先，加载包。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;R.matlab&#39;</span>)</code></pre>
<p>在R中打开<code>matlab server</code>。</p>
<pre class="sourceCode r"><code class="sourceCode r">Matlab<span class="op">$</span><span class="kw">startServer</span>()</code></pre>
<p>效果就是可以看到matlab窗口以最小化的形式出现，不过里面没有视图，大家可以不必理会。后续操作均在R中完成。</p>
<p>其次创建matlab对象，用于与Matlab通讯。</p>
<pre class="sourceCode r"><code class="sourceCode r">matlab &lt;-<span class="st"> </span><span class="kw">Matlab</span>()</code></pre>
<p>然后，把要优化的函数（<strong>使用matlab定义</strong>），写入R。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setFunction</span>(matlab, <span class="st">&quot; \</span>
<span class="st">  function z=test(x) \</span>
<span class="st">            %test function \</span>
<span class="st">            z = 100 *(x(2) - x(1).^2).^2+(x(1)-1).^2;\</span>
<span class="st">            &quot;</span>)</code></pre>
<p>这段代码，在matlab的本地服务器创建了一个M函数，如下所示。注意用<code>\</code>号的使用。</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">function z =test(x,y)
  <span class="co">%test function</span>
  z=<span class="fl">100</span>*(y-x.^<span class="fl">2</span>).^<span class="fl">2</span>+(x-<span class="fl">1</span>).^<span class="fl">2</span>;</code></pre>
<p>接下来我们创建目标函数。</p>
<pre class="sourceCode r"><code class="sourceCode r">func_MR &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  <span class="kw">setVariable</span>(matlab,<span class="dt">x =</span> x) <span class="co"># 把R里面的x，赋值到matlab里面的x变量</span>
  <span class="kw">evaluate</span>(matlab,<span class="st">&#39;z = test(x)&#39;</span>) <span class="co"># 在matlab里面执行 z = test(x) 命令</span>
  res &lt;-<span class="st"> </span><span class="kw">getVariable</span>(matlab,<span class="kw">c</span>(<span class="st">&#39;z&#39;</span>)) <span class="co"># 从matlab里面读取 z 变量</span>
  <span class="kw">return</span>(res<span class="op">$</span>z) <span class="co">#返回z值</span>
}</code></pre>
<p>这段代码块思路是，既然利用的是rBAS包，那么每次更新，都利用上一回合R计算的值，传递到matlab里面。然后，在matlab里面执行用户定义的函数。最后再用R把matlab里面算出来的变量值读取出来。</p>
<p>这就是我们新的优化函数，虽然绕一点，但是是容易想到和理解的办法。接下来就是使用rBAS包来优化这个目标函数了。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>({
  fit&lt;-
<span class="st">    </span><span class="kw">BSOoptim</span>(<span class="dt">fn =</span> func_MR,
             <span class="dt">init =</span> <span class="ot">NULL</span>,
             <span class="dt">s =</span> <span class="dv">2</span>,
             <span class="dt">lower =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">50</span>),
             <span class="dt">upper =</span> <span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>),
             <span class="dt">n =</span> <span class="dv">1</span>,
             <span class="dt">w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
             <span class="dt">w_vs =</span> <span class="fl">0.4</span>, 
             <span class="dt">step =</span> <span class="dv">10</span>,
             <span class="dt">step_w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
             <span class="dt">c =</span> <span class="dv">8</span>,
             <span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.12</span>,<span class="fl">5.12</span>),
             <span class="dt">trace =</span> T,<span class="dt">seed =</span> <span class="dv">1</span>)
}) </code></pre>
<p>我们使用了一段<code>BSO</code>算法的优化代码，但是，粒子数目设置为2，回合数只设置为1。结果，这么简单的计算，要花费<strong>13s</strong>。两个软件来回通讯占用了大量的时间，我相信，应该不会有用户愿意等待这么长久的时间。这个完整的优化过程，之后会有纯R代码，求解过程不到0.1s的时间。</p>
<p>最后呢，需要使用下面的代码关闭matlab服务器。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">close</span>(matlab)</code></pre>
<p>R代码使用<code>BSO</code>解这个优化问题是这样的效果。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rBAS)

test &lt;-<span class="st"> </span><span class="cf">function</span>(x){
  z &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span>(x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(x[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>
}

<span class="kw">system.time</span>({
  fit&lt;-
<span class="st">    </span><span class="kw">BSOoptim</span>(<span class="dt">fn =</span> test,
             <span class="dt">init =</span> <span class="ot">NULL</span>,
             <span class="dt">lower =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">50</span>),
             <span class="dt">upper =</span> <span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>),
             <span class="dt">n =</span> <span class="dv">300</span>,
             <span class="dt">w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
             <span class="dt">w_vs =</span> <span class="fl">0.4</span>, 
             <span class="dt">step =</span> <span class="dv">10</span>,
             <span class="dt">step_w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
             <span class="dt">c =</span> <span class="dv">8</span>,
             <span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.12</span>,<span class="fl">5.12</span>),
             <span class="dt">trace =</span> F,<span class="dt">seed =</span> <span class="dv">1</span>)
})</code></pre>
<pre><code>##    user  system elapsed 
##    0.08    0.02    0.10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">fit<span class="op">$</span>par</code></pre>
<pre><code>## [1] 1 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">fit<span class="op">$</span>value</code></pre>
<pre><code>## [1] 0</code></pre>
<p>时间短，而且能求出理论的最小值。这也反映了第二个方法过于低效的问题，我们看看借助第三方语言能否行得通。</p>
</div>
<div id="cc" class="section level2">
<h2><span class="header-section-number">9.2</span> 中转站：C/C++</h2>
<p>matlab的<code>matlab Coder</code>可以让用户把自己的代码变成C或者C++，前提是，需要有编译器。不过，如果你使用过R，那么一般都会安装<a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>，这就意味着你安装了MinGw。下面的过程需要用到Rtools，还请大家自行下载安装。</p>
<p>打开matlab，输入下面的指令：</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab">mex -steup</code></pre>
<p>如果电脑中只安装过Rtools，而没有VS之类的编译器，一般会显示图<a href="matlabr.html#fig:mex">9.1</a>的界面。</p>
<div class="figure" style="text-align: center"><span id="fig:mex"></span>
<img src="img/mex.png" alt="mex -setup" width="95%" />
<p class="caption">
图 9.1: mex -setup
</p>
</div>
<p>第一句报错，是因为我并没有把Rtools中的mingw_64文件夹加入环境变量。因此，在执行第二句之后，再执行<code>mex -setup</code>就不会报错。</p>
<p>好了，加入你成功了，那么抛开前面所有的知识不看。现在说Coder工具箱。</p>
<p>假设你的路径下有2个M文件，一个是我们之前所说的测试函数<code>test.m</code>，还有一个是我们所说的，用来测试<code>test</code>函数的文件<code>test_main.m</code>文件。它们的代码如下。</p>
<pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% -------------test.m----------------%</span>

function z = test(x)
z = <span class="fl">100</span> *(x(<span class="fl">2</span>) - x(<span class="fl">1</span>).^<span class="fl">2</span>).^<span class="fl">2</span>+(x(<span class="fl">1</span>)-<span class="fl">1</span>).^<span class="fl">2</span>;</code></pre>
<pre class="sourceCode matlab"><code class="sourceCode matlab"><span class="co">% -------------test_main.m----------------%</span>

z = test([<span class="fl">1</span> <span class="fl">1</span>]);</code></pre>
<p>接下来我们点击Matlab菜单栏上的APP，在里面找到Matlab Coder工具箱打开，如图<a href="matlabr.html#fig:coder1">9.2</a>。</p>
<div class="figure" style="text-align: center"><span id="fig:coder1"></span>
<img src="img/coder1.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.2: Matlab Coder
</p>
</div>
<p>点击Enter a function name右边的 <span class="math inline">\(\cdots\)</span>符号，然后选中<code>test.m</code>文件，可以看到图<a href="matlabr.html#fig:coder2">9.3</a>的效果。</p>
<div class="figure" style="text-align: center"><span id="fig:coder2"></span>
<img src="img/coder2.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.3: Matlab Coder
</p>
</div>
<p>点击右下角<code>Next</code>按钮，可以看到如图<a href="matlabr.html#fig:coder3">9.4</a>的界面。</p>
<div class="figure" style="text-align: center"><span id="fig:coder3"></span>
<img src="img/coder3.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.4: Matlab Coder
</p>
</div>
<p>点击图<a href="matlabr.html#fig:coder3">9.4</a>红色箭头所指处，并选中<code>test_main.m</code>文件，点击<code>Autodefine Input types</code>，可以看到如图<a href="matlabr.html#fig:coder4">9.5</a>的界面，接下来就是一路的<code>Next</code>。</p>
<div class="figure" style="text-align: center"><span id="fig:coder4"></span>
<img src="img/coder4.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.5: Matlab Coder
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:coder5"></span>
<img src="img/coder5.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.6: Matlab Coder
</p>
</div>
<p>直到图<a href="matlabr.html#fig:coder6">9.7</a>，点击<code>Generate</code>按钮，生成C代码。</p>
<div class="figure" style="text-align: center"><span id="fig:coder6"></span>
<img src="img/coder6.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.7: Matlab Coder
</p>
</div>
<p>而后工具箱会给出<code>test.c</code>代码的预览，如图<a href="matlabr.html#fig:coder7">9.8</a>。</p>
<div class="figure" style="text-align: center"><span id="fig:coder7"></span>
<img src="img/coder7.png" alt="Matlab Coder" width="95%" />
<p class="caption">
图 9.8: Matlab Coder
</p>
</div>
<p>我相信，大家还是能看懂这段代码。对于简单的优化问题，我们照猫画虎，就可以写出对应的C或者C++的代码。如果不想写，还可以按照上述的方法生成。</p>
<p>那现在问题来了，如果我们有了C代码，如何在R语言中用了。</p>
<p>由于matlab生成的代码很多库都是matlab依赖的（我这么认为，不一定正确），所以我们需要简单地调整一下，把代码变得简洁。</p>
<p>原始的代码是这样的。</p>
<pre class="sourceCode c"><code class="sourceCode c"><span class="co">/* Include Files */</span>
<span class="pp">#include </span><span class="im">&quot;rt_nonfinite.h&quot;</span>
<span class="pp">#include </span><span class="im">&quot;test.h&quot;</span>

<span class="co">/* Function Definitions */</span>

<span class="co">/*</span>
<span class="co"> * Arguments    : const double x[2]</span>
<span class="co"> * Return Type  : double</span>
<span class="co"> */</span>
<span class="dt">double</span> test(<span class="dt">const</span> <span class="dt">double</span> x[<span class="dv">2</span>])
{
  <span class="dt">double</span> a;
  a = x[<span class="dv">1</span>] - x[<span class="dv">0</span>] * x[<span class="dv">0</span>];
  <span class="cf">return</span> <span class="fl">100.0</span> * (a * a) + (x[<span class="dv">0</span>] - <span class="fl">1.0</span>) * (x[<span class="dv">0</span>] - <span class="fl">1.0</span>);
}

<span class="co">/*</span>
<span class="co"> * File trailer for test.c</span>
<span class="co"> *</span>
<span class="co"> * [EOF]</span>
<span class="co"> */</span></code></pre>
<p>我们进行<strong>微调</strong>（大家肯定是能理解并模仿的），变成R可以正确编译的。注意，由于Rcpp能让R和C++无缝贴合的强大功能，我把代码调整为了C++。后面的<code>Michalewicz function</code>，<code>Pressure Vessel function</code>均是用C++所写。</p>
<pre class="rcpp"><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;
// [[Rcpp::export]]
double test(NumericVector x) {
  double a;
  a = x[1] - x[0] * x[0];
  return 100.0 * (a*a) + (x[0] - 1.0) * (x[0] - 1.0);
}</code></pre>
<p>把这段代码保存成<code>Rcpptest.cpp</code>文件，然后在R里面执行代码：</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp) <span class="co">#加载Rcpp包</span>
<span class="kw">sourceCpp</span>(<span class="st">&#39;你的Rcpptest.cpp文件路径&#39;</span>) <span class="co">#编译之前保存的cpp文件</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#执行BSO优化算法函数</span>
<span class="kw">system.time</span>({
  fit&lt;-<span class="kw">BSOoptim</span>(<span class="dt">fn =</span> test, <span class="co">#调用了编译的C++中的test函数</span>
                <span class="dt">init =</span> <span class="ot">NULL</span>,
                <span class="dt">lower =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>,<span class="op">-</span><span class="dv">50</span>),
                <span class="dt">upper =</span> <span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">50</span>),
                <span class="dt">n =</span> <span class="dv">300</span>,
                <span class="dt">w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
                <span class="dt">w_vs =</span> <span class="fl">0.4</span>, 
                <span class="dt">step =</span> <span class="dv">10</span>,
                <span class="dt">step_w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
                <span class="dt">c =</span> <span class="dv">8</span>,
                <span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.12</span>,<span class="fl">5.12</span>),
                <span class="dt">trace =</span> F,<span class="dt">seed =</span> <span class="dv">1</span>)
})</code></pre>
<pre><code>##    user  system elapsed 
##    0.09    0.00    0.10</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看优化参数</span>
fit<span class="op">$</span>par</code></pre>
<pre><code>## [1] 1 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看优化结果</span>
fit<span class="op">$</span>value</code></pre>
<pre><code>## [1] 0</code></pre>
<p>执行速度很快，大家可能会有疑问，为啥看起来比纯R代码执行的时间还要长一点。这是因为你多次执行，耗时和电脑所处的状态有关系，这点误差是正常的。但是，如果是计算量较大的代码，利<strong>用Rcpp会比R要节省大量的时间</strong>。</p>
<p>接下来我们看看另外两个例子，也就是<code>Michalewicz function</code>和<code>Pressure Vessel function</code>函数的优化问题。</p>
<p><code>Michalewicz function</code> 也可以先用matlab生成C或者C++代码，然后稍作改编，保存为<code>Rcppmich.cpp</code>文件，代码如下：</p>
<pre class="rcpp"><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;

// [[Rcpp::export]]
double michcpp(NumericVector x) {
  double x0;
  double x1;
  x0 = -sin(x[0])*pow(sin((pow(x[0],2))/M_PI),20);
  x1 = -sin(x[1])*pow(sin((2*pow(x[1],2))/M_PI),20);
  return x0+x1;
}
</code></pre>
<p>和matlab或者R代码比起来，也是十分易懂的。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp) <span class="co">#加载Rcpp包</span>
<span class="kw">sourceCpp</span>(<span class="st">&#39;你的Rcppmich.cpp文件路径&#39;</span>) <span class="co">#编译之前保存的cpp文件</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#执行BAS优化算法函数</span>
<span class="kw">system.time</span>({
  fit&lt;-<span class="kw">BASoptim</span>(<span class="dt">fn =</span> michcpp, <span class="co">#利用了C++中的michcpp函数</span>
                <span class="dt">lower =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dt">upper =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>),
                <span class="dt">seed =</span> <span class="dv">1</span>, <span class="dt">n =</span> <span class="dv">100</span>,<span class="dt">trace =</span> <span class="ot">FALSE</span>)
})</code></pre>
<pre><code>##    user  system elapsed 
##       0       0       0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看优化参数</span>
fit<span class="op">$</span>par</code></pre>
<pre><code>## [1] -4.964687  1.575415</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看优化结果</span>
fit<span class="op">$</span>value</code></pre>
<pre><code>## [1] -1.966817</code></pre>
<p>对于<code>Pressure Vessel function</code>，保存为<code>RcppPV.cpp</code>文件，代码如下：</p>
<pre class="rcpp"><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;

// [[Rcpp::export]]
double PVobj(NumericVector x) {
  double x0 = floor(x[0])*0.0625;
  double x1 = floor(x[1])*0.0625;
  double x2 = x[2];
  double x3 = x[3];
  
  double result = 0.6224*x0*x2*x3 + 1.7781*x1*pow(x2,2) 
    +3.1611*pow(x0,2)*x3 + 19.84*pow(x0,2)*x2;
  return result;
}

// [[Rcpp::export]]
NumericVector PVcon(NumericVector x) {
  double x0 = floor(x[0])*0.0625;
  double x1 = floor(x[1])*0.0625;
  double x2 = x[2];
  double x3 = x[3];
  
  NumericVector constraint(3);
  constraint[0] = 0.0193*x2 - x0;
  constraint[1] = 0.00954*x2 - x1;
  constraint[2] = 750.0*1728.0 - 3.141593*pow(x2,2)*x3 
    - (4.0/3.0)*3.141593*pow(x2,3);
  return constraint;
}
</code></pre>
<p>其中，<code>PVobj</code>是目标函数，<code>PVcon</code>是约束函数。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp) <span class="co">#加载Rcpp包</span>
<span class="kw">sourceCpp</span>(<span class="st">&#39;你的RcppPV.cpp文件路径&#39;</span>) <span class="co">#编译之前保存的cpp文件</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#执行BSO优化算法函数</span>
<span class="kw">system.time</span>({
  fit&lt;-<span class="kw">BSOoptim</span>(<span class="dt">fn =</span> PVobj, <span class="co">#C++中的PVobj函数</span>
         <span class="dt">init =</span> <span class="ot">NULL</span>,
         <span class="dt">constr =</span> PVcon, <span class="co">#C++中的PVcon函数</span>
         <span class="dt">lower =</span> <span class="kw">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">10</span>),
         <span class="dt">upper =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">200</span>),
         <span class="dt">n =</span> <span class="dv">1000</span>,
         <span class="dt">w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
         <span class="dt">w_vs =</span> <span class="fl">0.9</span>,
         <span class="dt">step =</span> <span class="dv">100</span>,
         <span class="dt">step_w =</span> <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">0.4</span>),
         <span class="dt">c =</span> <span class="dv">35</span>,
         <span class="dt">v =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">5.12</span>,<span class="fl">5.12</span>),
         <span class="dt">trace =</span> F,<span class="dt">seed =</span> <span class="dv">1</span>,
         <span class="dt">pen =</span> <span class="fl">1e6</span>)
})</code></pre>
<pre><code>##    user  system elapsed 
##    1.58    0.00    1.59</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看优化参数</span>
fit<span class="op">$</span>par</code></pre>
<pre><code>## [1]  13.948846   7.541387  42.098446 176.636570</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看优化结果</span>
fit<span class="op">$</span>value</code></pre>
<pre><code>## [1] 6059.131</code></pre>
<p>结果很好，耗时也可以接受。不过，在写<code>BSOoptim</code>函数的时候，我使用了2层的循环来嵌套，因此，<code>BSOoptim</code>函数比rBAS包中其他的函数要慢上一些。后续我打算使用Rcpp把<code>BSOoptim</code>重写一遍，这样对大型的优化问题耗时会更容易接受。</p>
<p>下面是<code>BSASoptim</code>对该问题的优化结果，同样也是采用C++编译的方式。</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>({
  result &lt;-<span class="st"> </span><span class="kw">BSASoptim</span>(<span class="dt">fn =</span> PVobj,
                      <span class="dt">k =</span> <span class="dv">5</span>,
                      <span class="dt">lower =</span><span class="kw">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">10</span>),
                      <span class="dt">upper =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">200</span>),
                      <span class="dt">constr =</span> PVcon,
                      <span class="dt">n =</span> <span class="dv">1000</span>,
                      <span class="dt">step =</span> <span class="dv">100</span>,
                      <span class="dt">d1 =</span> <span class="dv">5</span>,
                      <span class="dt">pen =</span> <span class="fl">1e6</span>,
                      <span class="dt">steptol =</span> <span class="fl">1e-6</span>,
                      <span class="dt">n_flag =</span> <span class="dv">2</span>,
                      <span class="dt">seed =</span> <span class="dv">2</span>,<span class="dt">trace =</span> <span class="ot">FALSE</span>)
})</code></pre>
<pre><code>## ----step &lt; steptol---------stop the iteration------</code></pre>
<pre><code>##    user  system elapsed 
##    0.40    0.00    0.44</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">result<span class="op">$</span>par</code></pre>
<pre><code>## [1]  14.908531   7.652175  43.541638 159.543000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">result<span class="op">$</span>value</code></pre>
<pre><code>## [1] 6305.57</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="python.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="paper.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
